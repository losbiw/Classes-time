(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{20:function(e,t,a){e.exports=a(30)},29:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(13),l=a.n(i),s=a(6),u=a.n(s),o=a(8),c=a(2),m=a(3),h=a(7),v=a(5),d=a(4);var f=function(e){var t,a=e.name;return r.a.createElement("h1",{className:"title-".concat(a)},(t=e.value)?t.charAt(0).toUpperCase()+t.substr(1):null)};var p=function(e){return r.a.createElement("p",{className:"warning"},e.value||"\u200f\u200f\u200e \u200e")};var g=function(e){var t,a=e.value,n=e.handler;return r.a.createElement("input",{type:"confirmation"!==a?a:"password",key:a,name:a,placeholder:(t=a,t.charAt(0).toUpperCase()+t.substr(1)),required:!0,onChange:n,className:"input"})};var b=function(e){return r.a.createElement("input",{type:"submit",value:"Submit",className:"submit",onClick:e.handler})};var y=function(e){for(var t=e.value,a=e.handler,n=e.className,i=[],l=1;l<=11;l++)for(var s="\u0410".charCodeAt(0),u=0;u<3;u++){var o=l+String.fromCharCode(s);i.push(o),s++}return r.a.createElement("select",{onChange:a,defaultValue:t,name:"form",className:n},i.map((function(e){return r.a.createElement("option",{value:e,key:e},e)})))};var E=function(e){var t=["email","password"],a=e.handlers,n=a.handleSubmit,i=a.handleChange;return e.isLogin||t.push("confirmation"),r.a.createElement("form",{className:"login-form",onSubmit:n},!e.isLogin&&r.a.createElement(y,{handler:i,className:"input"}),t.map((function(e){return r.a.createElement(g,{value:e,key:e,handler:i})})),r.a.createElement(p,{value:e.warning}),r.a.createElement(b,null))};var j=function(e){var t=e.handler,a=e.value,n=e.className;return r.a.createElement("button",{className:n,onClick:t},a)},O=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).changeAction=function(){n.setState({isLogin:!n.state.isLogin})},n.handleChange=function(e){e.preventDefault();var t=e.target,a=t.name,r=t.value,i=n.state.inputData,l=i||{};l[a]=r,n.setState({inputData:l})},n.handleSubmit=function(e){e.preventDefault();var t=n.props.handler,a=n.state,r=a.inputData,i=a.isLogin,l=r.password,s=r.confirmation,u=JSON.stringify(r);i?t("/account/login",u,"post","userData"):l===s?(t("/account/signup",u,"post","userData"),n.setState({isLogin:!0})):n.setState({warning:"The passwords should match"})},n.state={inputData:{form:"1\u0410"},warning:"",isLogin:!0},n}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props.warning;t!==e.warning&&this.setState({warning:t})}},{key:"render",value:function(){var e=this.state,t=this.changeAction,a=this.handleSubmit,n=this.handleChange,i=e.isLogin,l=e.warning;return r.a.createElement("div",{className:"login-container"},r.a.createElement("div",{className:"login"},r.a.createElement(f,{value:i?"Log In":"Sign Up",name:"login"}),r.a.createElement(E,{isLogin:i,handlers:{handleSubmit:a,handleChange:n},warning:l}),r.a.createElement(j,{value:i?"Don't have an account? Sign Up":"Already have an account? Log In",handler:t,className:"change-action"})))}}]),a}(n.Component),S=a(14),k=a(18);var w=function(e){var t=e.value,a=e.isAdmin,n=e.lessons,i=e.name,l=e.handler,s=e.element,u=0;return r.a.createElement("div",{className:"day"},r.a.createElement(f,{value:t,name:"day"}),r.a.createElement("ol",null,n.map((function(e){if(e||a){var n="".concat(t).concat(u),o=r.a.createElement(s,{value:e,key:n,name:"".concat(i,"[").concat(u,"]"),handler:l});return u++,o}}))))},C=a(11);var N=function(e){var t=e.max,a=e.value,n=e.name,i=e.handler,l=e.obj;return r.a.createElement("input",{type:"number",min:"0",max:t,defaultValue:a,onChange:i,obj:l,name:n})};var D=function(e){var t=e.object,a=e.handler,n=e.value,i=e.isFirst,l=n.hours,s=n.minutes;return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(N,{value:l,max:"23",obj:t,name:"hours",handler:a}),r.a.createElement("div",null,":"),r.a.createElement(N,{value:s,max:"59",obj:t,name:"minutes",handler:a}),i&&r.a.createElement("div",null,"\xa0-\xa0"))};function A(e){return r.a.createElement("li",null,e.value)}function L(e){var t=e.value,a=Object.keys(t),n=!0;return r.a.createElement("li",{className:"time-item"},a.map((function(e){var a=t[e],i=a.hours,l=T(a.minutes),s=r.a.createElement("div",{style:{display:"flex"},key:e},r.a.createElement("div",null,i,":",l),n&&r.a.createElement("div",null,"\xa0-\xa0"));return n=!1,s})))}function x(e){var t=e.value,a=e.name,n=e.handler;return r.a.createElement("li",null,r.a.createElement("input",{type:"text",defaultValue:t,name:a,onChange:n,className:"item-input"}))}var M=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handler=function(e){e.preventDefault();var t=n.props,a=t.handler,r=t.name,i=e.target,l=i.name,s=i.value,u=e.target.getAttribute("obj"),o=0==s?0:parseInt(s,10)||s,c=Object(C.a)({},n.state);c[u][l]=o,n.setState(c,(function(){for(var e={},t=0,i=Object.keys(n.state);t<i.length;t++){var l=i[t],s=n.state[l],u=s.hours,o=s.minutes;e[l]=n.convertIntoMs(u,o)}a(r,e)}))},n.state={beginning:{},ending:{}},n}return Object(m.a)(a,[{key:"map",value:function(e,t,a,n,r){return(e-t)*(r-n)/(a-t)+n}},{key:"componentDidMount",value:function(){for(var e=this.props.value,t=0,a=Object.keys(e);t<a.length;t++){var n=a[t],r=e[n].minutes;e[n].minutes=T(r)}this.setState(e)}},{key:"convertIntoMs",value:function(e,t){var a=e+(t=.01*this.map(t,0,60,0,100));return Math.round(36e5*a)}},{key:"render",value:function(){var e=this,t=this.state,a=Object.keys(t),n=!0;return r.a.createElement("li",{className:"time-item-input"},a.map((function(a){var i=r.a.createElement(D,{value:t[a],handler:e.handler,isFirst:n,object:a,key:a});return n=!1,i})))}}]),a}(n.Component);function T(e){var t=null===e||void 0===e?void 0:e.toString();return(null===t||void 0===t?void 0:t.length)<2?"0"+t:t}var I=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(c.a)(this,a);var r=(n=t.call(this,e)).props.schedule.map((function(e){for(var t=Object(C.a)({},e),a=0,r=Object.keys(t);a<r.length;a++){var i=r[a],l=n.convertFromMs(t[i]);t[i]=l}return t}));return n.state={schedule:r},n}return Object(m.a)(a,[{key:"map",value:function(e,t,a,n,r){return(e-t)*(r-n)/(a-t)+n}},{key:"convertFromMs",value:function(e){var t=e/36e5,a=Math.floor(t),n=Math.round(100*(t-a));return{hours:a,minutes:Math.round(this.map(n,0,100,0,60))}}},{key:"render",value:function(){var e=this.props,t=e.isAdmin,a=e.handler,n=t?M:L;return r.a.createElement(w,{lessons:this.state.schedule,element:n,value:"schedule",name:"schedule",handler:a})}}]),a}(n.Component),U=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault(),n.props.handler("/timetable/",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.state.data)})},n.handleChange=function(e){e.preventDefault();var t=e.target,a=t.name,r=t.value;n.changeState(a,r)},n.changeState=function(e,t){var a=n.accessNestedObject(e,n.state.data,t);n.setState({data:a})},n.state={data:n.props.data},n}return Object(m.a)(a,[{key:"accessNestedObject",value:function(e,t,a){var n,r,i=e.match(/[^\[]*/),l=Object(k.a)(e.matchAll(/\[(.*?)\]/g)),s=Object(S.a)(l);try{for(s.s();!(r=s.n()).done;){var u=r.value[1];i.push(u)}}catch(c){s.e(c)}finally{s.f()}for(var o=0;o<i.length;o++)n=0===o?this.property(t,i[o]).value:o===i.length-1?this.property(n,i[o]):this.property(n,i[o]).value;return n.value=a,t}},{key:"property",value:function(e,t){return t=0==t?0:parseInt(t,10)||t,{get value(){return e[t]},set value(a){e[t]=a}}}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"render",value:function(){var e=this.state,t=this.handleChange,a=this.changeState,n=this.handleSubmit,i=e.data,l=this.props.isAdmin,s=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],u=l?x:A,o=0,c={schedule:i.schedule};return r.a.createElement("form",{className:"table"},r.a.createElement(I,Object.assign({isAdmin:l,handler:a},c)),i.timetable.map((function(e){var a=s[o],n=r.a.createElement(w,{lessons:e,element:u,value:a,key:a,name:"timetable[".concat(o,"]"),handler:t,isAdmin:l});return o++,n})),l&&r.a.createElement(b,{handler:n}))}}]),a}(n.Component),F=a(19),J=function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).changeState=function(e,t){var a={};a[e]=t,n.setState(a)},n.changetableState=function(){var e=!n.state.isTableVisible;n.changeState("isTableVisible",e)},n.logoutHandler=function(){localStorage.removeItem("login"),window.location.reload()},n.selectChange=function(){var e=Object(o.a)(u.a.mark((function e(t){var a,r,i,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,r=n.props.auth,i=r.email,l=r.password,e.next=4,n.props.handler("/account/form",{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i,password:l,form:a})});case 4:window.location.reload();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var r=Object(h.a)(n),i=r.getMsSinceMidnight,l=r.getCurrentDay,s=r.getCurrentLesson,m=n.props.timetable,v=m.timetable,d=m.schedule,f="The timetable doesn't exist";m.isGenerated||(f=s(i(),d,v[l()]));return n.state={currentLesson:f,isTableVisible:!1},n}return Object(m.a)(a,[{key:"getCurrentDay",value:function(){return((new Date).getDay()+6)%7}},{key:"getMsSinceMidnight",value:function(){var e=new Date;return new Date(e)-e.setHours(0,0,0,0)}},{key:"getCurrentLesson",value:function(e,t,a){if(a){if(e<t[0].beginning)return"The first lesson is ".concat(a[0]);if(e>=t[a.length-1].ending)return"Time to go home";for(var n=0;n<t.length;n++)if(e>=t[n].ending&&e<t[n+1].ending)return a[n+1];return a[0]}return"It's a day off"}},{key:"render",value:function(){var e=this.state,t=this.props,a=(this.changetableState,this.logoutHandler),n=this.selectChange,i=t.general,l=t.timetable,s=t.handler,u={list:"list",logout:"logout"};for(var o in u)u[o]=r.a.createElement(F.a,{src:"icons/".concat(o,".svg")});return r.a.createElement("div",{className:"user"},r.a.createElement("nav",null,r.a.createElement(y,{value:i.form,handler:n,className:"user-select"}),r.a.createElement("div",{className:"buttons"},!l.removeSwitch&&r.a.createElement(j,{handler:this.changetableState,value:u.list,className:"user-button"}),r.a.createElement(j,{handler:a,value:u.logout,className:"user-button"}))),e.isTableVisible?r.a.createElement(U,{data:l,isAdmin:i.isAdmin,handler:s}):r.a.createElement(f,{value:e.currentLesson,name:"user"}))}}]),a}(n.Component),V=(a(29),function(e){Object(v.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).fetchDataToState=function(e,t,a,r){var i=Object(h.a)(n).fetchAPI,l={method:a,headers:{"Content-Type":"application/json"}};return"get"!==a&&(l.body=t),new Promise((function(t){i(e,l).then((function(e){return JSON.parse(e)})).then((function(e){var a=n.state.userData||{};a[r]=e,n.setState(a,(function(){return t()}))}))}))},n.state={userData:null},n}return Object(m.a)(a,[{key:"fetchAPI",value:function(){var e=Object(o.a)(u.a.mark((function e(t,a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getFromLocal",value:function(){return localStorage.getItem("login")}},{key:"componentDidMount",value:function(){var e=Object(o.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getFromLocal,a=this.fetchDataToState,!(n=t())){e.next=5;break}return e.next=5,a("/account/login",n,"post","userData");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderUser",value:function(e){var t=this.fetchAPI,a=this.state.userData,n=a.general,i=a.auth,l={email:i.email,password:i.password},s=JSON.stringify(l);return this.getFromLocal()||localStorage.setItem("login",s),r.a.createElement(J,{general:n,timetable:e,handler:t,auth:l})}},{key:"render",value:function(){var e,t,a=this.fetchDataToState,n=this.state.userData;if((null===n||void 0===n?void 0:n.general)&&(null===n||void 0===n||null===(e=n.form)||void 0===e?void 0:e.timetable))return this.renderUser(n.form);if(null===n||void 0===n||null===(t=n.general)||void 0===t?void 0:t.isAdmin){var i=Array(8).fill({beginning:0,ending:0}),l=Array(8).fill(""),s={schedule:i,timetable:Array(5).fill(l),form:n.general.form,isGenerated:!0,showTableFirst:!0};return this.renderUser(s)}if(null===n||void 0===n?void 0:n.general)return this.renderUser({isGenerated:!0,removeSwitch:!0});var u=null===n||void 0===n?void 0:n.warning;return r.a.createElement(O,{handler:a,warning:u})}}]),a}(n.Component));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.a3db6cc8.chunk.js.map